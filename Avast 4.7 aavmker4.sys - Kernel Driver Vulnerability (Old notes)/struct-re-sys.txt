IRP structure
==============  
  +0x040 Tail             : union __unnamed, 3 elements, 0x30 bytes
      +0x000 Overlay          : struct __unnamed, 8 elements, 0x28 bytes
         +0x000 DeviceQueueEntry : struct _KDEVICE_QUEUE_ENTRY, 3 elements, 0x10 bytes
         +0x000 DriverContext    : [4] ???? 
         +0x010 Thread           : ???? 
         +0x014 AuxiliaryBuffer  : ???? 
         +0x018 ListEntry        : struct _LIST_ENTRY, 2 elements, 0x8 bytes
         +0x020 CurrentStackLocation : ????		---> 
         +0x020 PacketType       : ??
         +0x024 OriginalFileObject : ???? 
		 
IO_STACK_LOCATION struct
=========================
struct		// 4 elements, 0x10 bytes (sizeof)
{
	/*0x004*/     ULONG32	OutputBufferLength;
	/*0x008*/     ULONG32   InputBufferLength;
	/*0x00C*/     ULONG32   IoControlCode;
	/*0x010*/     VOID*     Type3InputBuffer;
}DeviceIoControl;

		 
Offset:
	_IO_STACK_LOCATION (0x040 + 0x020 = 0x60) 
		.text:000109B5 8B 43 60                                mov     eax, [ebx+0x60]  ; eax = CurrentStackLocation (pointer to _IO_STACK_LOCATION)
		
		Tail + CurrentStackLocation = Offset
		
		union	// 2 elements, 0x4 bytes (sizeof)
		{
			struct _IO_STACK_LOCATION* CurrentStackLocation;	/*0x060*/
			ULONG32      PacketType;							/*0x060*/
		};
	
	ULONG InputBufferLength (0x008)	
		.text:000109B8 8B 70 08                                mov     esi, [eax+8]     ; ULONG InputBufferLength = esi
		
	ULONG OutputBufferLength (0x004)
		.text:000109BE 8B 50 04                                mov     edx, [eax+4]		; ULONG OutputBufferLength = edx
		
	ULONG IoControlCode (0x00C)
		.text:000109C4 8B 40 0C                                mov     eax, [eax+0Ch]	; ULONG IoControlCode = eax
		

Associated IRP
==============
ebx holds pointer of IRP, then store in eax:
	.text:00010CF1 8B 43 0C                                mov     eax, [ebx+0Ch]  ; ebx holds pointer of IRP
	.text:00010CF4 8B 00                                   mov     eax, [eax]

+0x00c AssociatedIrp    : union __unnamed, 3 elements, 0x4 bytes
    +0x000 MasterIrp        : ???? 
    +0x000 IrpCount         : ??
    +0x000 SystemBuffer     : ???? 

	10CF1 belongs to IRP->AssociatedIrp. At the offset 10CF4, input buffer store in EAX (IRP->AssociatedIrp.SystemBuffer)
